<?php

namespace Frontend\FrontOfficeBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * GameRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class GameRepository extends EntityRepository
{
    public function findStartWithInArray($_start)
    {
        //$all_games = $this->findBy(array("name" => "%$_start%"));
        
        $qb = $this->createQueryBuilder('g');
        
        $query = $qb->where('g.name LIKE :name')
         ->setParameter('name',"%$_start%")
         ->getQuery();
         
        $all_games = $query->getResult();
        
        $res_games = array();
        $l = count($all_games);
        for($i=0; $i<$l; $i++)
        {
            $game = $all_games[$i];
            $id = $game->getId();
            $res_games[$id]['id'] = $game->getId();
            $res_games[$id]['name'] = $game->getName();
            $res_games[$id]['plateform'] = $game->getPlateform()->getValue();
            $res_games[$id]['plateform_id'] = $game->getPlateform()->getId();
            $res_games[$id]['editor_1'] = $game->getEditor1()->getValue();
            $res_games[$id]['editor_1_id'] = $game->getEditor1()->getId();
            
            if($game->getEditor2() != null)
            {
                $res_games[$id]['editor_2'] = $game->getEditor2()->getValue();
                $res_games[$id]['editor_2_id'] = $game->getEditor2()->getId();
            }
            else
            {
                $res_games[$id]['editor_2'] = null;
                $res_games[$id]['editor_2_id'] = 0;
            }
            
            if($game->getEditor3() != null)
            {
                $res_games[$id]['editor_3'] = $game->getEditor3()->getValue();
                $res_games[$id]['editor_3_id'] = $game->getEditor3()->getId();
            }
            else
            {
                $res_games[$id]['editor_3'] = null;
                $res_games[$id]['editor_3_id'] = 0;
            }
            
            if($game->getSeries() != null)
            {
                $res_games[$id]['serie'] = $game->getSeries()->getValue();
                $res_games[$id]['serie_id'] = $game->getSeries()->getId();
            }
            else
            {
                $res_games[$id]['serie'] = null;
                $res_games[$id]['serie_id'] = 0;
            }
            $res_games[$id]['game_type'] = $game->getGameType()->getValue();
            $res_games[$id]['game_type_id'] = $game->getGameType()->getId();
            $res_games[$id]['released_year'] = $game->getReleasedYear();
            $res_games[$id]['image_1'] = $game->getImage1();
            $res_games[$id]['image_2'] = $game->getImage2();
            $res_games[$id]['image_3'] = $game->getImage3();
        }
        
        return $res_games;
    }
}
