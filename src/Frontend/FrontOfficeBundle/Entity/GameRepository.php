<?php

namespace Frontend\FrontOfficeBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * GameRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class GameRepository extends EntityRepository
{
    public function findFormattedGameInfos($_id)
    {
        // Ne récupérer que nom et id + event select : aller chercher les infos de ce jeu
        $qb = $this->createQueryBuilder("g");
    
        $query = 
          $qb->select('g.name, g.id, 
                        s.id as serie_id, s.value as serie_val, 
                        p.id as plateform_id, p.value as plateform_val, 
                        gt.id as game_type_id, gt.value as game_type_val, 
                        e1.id as editor_1_id, e1.value as editor_1_val, 
                        e2.id as editor_2_id, e2.value as editor_2_val, 
                        e3.id as editor_3_id, e3.value as editor_3_val, 
                        g.image_game,
                        g.released_year')
         ->leftJoin('g.serie', 's')
         ->leftJoin('g.plateform', 'p')
         ->leftJoin('g.game_type', 'gt')
         ->leftJoin('g.editor_1', 'e1')
         ->leftJoin('g.editor_2', 'e2')
         ->leftJoin('g.editor_3', 'e3')
         ->where('g.id = '.$_id)
         ->getQuery();
         
         return $query->getSingleResult();
    }
}
